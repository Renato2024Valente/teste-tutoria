<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutoria Digital</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #9dc9f7;
            padding: 20px;
        }

        .container {
            background-color: #e4e9f1;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #343a40;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            font-weight: bold;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 50px;
        }

        .signature-pad {
            border: 1px solid #ced4da;
            border-radius: 5px;
            width: 100%;
            height: 200px;
            cursor: crosshair;
        }

        button {
    margin-top: 10px;
}

.input-group .btn {
    margin-top: 0 !important;
    height: 100%;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}


        .tutoria-list {
            margin-top: 30px;
        }

        .tutoria-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .student-info {
            display: flex;
            gap: 10px;
        }

        .small-input {
            flex: 1;
        }
    </style>

<script>
document.addEventListener('contextmenu', event => event.preventDefault());
document.onkeydown = function(e) {
    if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
        return false;
    }
};
</script>

</head>

<!-- Modal para senha -->
<div class="modal fade" id="modalSenha" tabindex="-1" role="dialog" aria-labelledby="modalSenhaLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalSenhaLabel">Acesso restrito</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <input type="password" class="form-control" id="senhaModal" placeholder="Digite a senha para buscar tutorias">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-success" onclick="validarSenhaModal()">Confirmar</button>
        </div>
      </div>
    </div>
  </div>
  
<body>
    

    <div class="container">
        <div class="form-group">
            <label for="filtroSerie">Filtrar por S√©rie</label>
            <input type="text" class="form-control" id="filtroSerie" placeholder="Ex: 8A, 9B">
        </div>
        
              
        <!-- CAMPO DE BUSCA DENTRO DA CONTAINER -->
        <div class="form-group">
            <label for="filtroNome">Buscar Tutorias por Nome</label>
            <div class="input-group mb-3">
                <input type="text" id="filtroNome" class="form-control" placeholder="Digite o nome do aluno">
                <div class="input-group-append">
                    
                    <button class="btn btn-success" type="button" data-toggle="modal" data-target="#modalSenha">Buscar</button>


                </div>
            </div>
        </div>
    
    
    <div class="container">
        <h1>Tutoria Digital</h1>
        <form id="tutoriaForm">
            <div class="form-group">
                <label for="nomeFuncionario">TUTOR</label>
                <input type="text" class="form-control" id="nomeTutor" required>
            </div>

            <!-- Nome do aluno e s√©rie juntos -->
            <div class="student-info">
                <div class="form-group">
                    <label for="nomeAluno">Nome do Aluno</label>
                    <input type="text" class="form-control" id="nomeAluno" required>
                </div>
                <div class="form-group small-input">
                    <label for="serie">S√©rie</label>
                    <input type="text" class="form-control" id="serie">
                </div>
            </div>

            <!-- Removido nome do pai, m√£e e endere√ßo -->

            <!-- Telefone e celular com op√ß√£o de adicionar mais n√∫meros -->
            <div class="form-group">
                <label for="telefoneCelular">Telefone e Celular</label>
                <div id="telefoneContainer">
                    <div class="input-group mb-2">
                        <input type="text" class="form-control" id="telefoneCelular" placeholder="(XX) XXXX-XXXX / (XX) XXXXX-XXXX">
                        <div class="input-group-append">
                            <button class="btn btn-success" type="button" onclick="adicionarNumero()">Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mantido projeto de vida -->
            <div class="form-group">
                <label for="projetoVida">Projeto de Vida</label>
                <textarea class="form-control" id="projetoVida" rows="3"></textarea>
            </div>

            <!-- Checkbox group mantido -->
            <div class="checkbox-group">
                <div>
                    <input type="checkbox" id="checkPessoal">
                    <label for="checkPessoal">Pessoal</label>
                </div>
                <div>
                    <input type="checkbox" id="checkPedagogico">
                    <label for="checkPedagogico">Pedag√≥gico</label>
                </div>
                <div>
                    <input type="checkbox" id="checkFamilia">
                    <label for="checkFamilia">Fam√≠lia</label>
                </div>
                <div>
                    <input type="checkbox" id="checkEmergencia">
                    <label for="checkEmergencia">Emerg√™ncia</label>
                </div>
                <div>
                    <input type="checkbox" id="checkProvaPaulista">
                    <label for="checkProvaPaulista">Prova Paulista</label>
                </div>
                <div>
                    <input type="checkbox" id="checkNotasBimestrais">
                    <label for="checkNotasBimestrais">Notas Bimestrais</label>
                </div>
                <div>
                    <input type="checkbox" id="checkComportamento">
                    <label for="checkComportamento">Comportamento</label>
                </div>
            </div>

            <!-- Assunto pessoal -->
            <div class="form-group">
                <label for="assuntoPessoal">Descri√ß√£o do Assunto</label>
                <textarea class="form-control" id="assuntoPessoal" rows="3"></textarea>
            </div>

            <!-- Mantido resto do formul√°rio -->
            <div class="form-group">
                <label for="carimboGestor">Carimbo do Prof (1234)</label>
                <input type="password" class="form-control" id="senhaGestor" placeholder="Digite a senha">
                <input type="text" class="form-control" id="carimboGestor" disabled>
            </div>
            <div class="form-group">
                <label>Data e Hora</label>
                <p id="dataHora"></p>
            </div>
            <div class="form-group">
                <label>Assinatura Digital do Aluno</label>
                <canvas id="signaturePadAluno" class="signature-pad"></canvas>
                <button type="button" class="btn btn-secondary mt-2" id="clearSignatureAluno">Limpar Assinatura do Aluno</button>
            </div>
            <button type="button" class="btn btn-primary" onclick="saveTutoria()">Salvar Tutoria</button>
            <button type="button" class="btn btn-warning" onclick="clearForm()">Limpar Formul√°rio</button>
            <button type="button" class="btn btn-info" onclick="sendWhatsApp()">Enviar Relat√≥rio por WhatsApp</button>
        </form>

        <div class="tutoria-list">
            <h2>Lista de Tutorias</h2>
            <div id="tutoriaList"></div>
        </div>

        <button type="button" class="btn btn-danger" onclick="deleteSelected()">Deletar Selecionados</button>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.13/jspdf.plugin.autotable.min.js"></script>
    <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
  // Configura√ß√£o do Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBzZMcJLZ1PfSgwhzXWTdf57XEPUwRxzkc",
    authDomain: "tutoria-digital-6059a.firebaseapp.com",
    databaseURL: "https://tutoria-digital-6059a-default-rtdb.firebaseio.com",
    projectId: "tutoria-digital-6059a",
    storageBucket: "tutoria-digital-6059a.appspot.com",
    messagingSenderId: "288646679070",
    appId: "1:288646679070:web:d83ee5db4670449e343c0f"
  };

  // Inicializa o Firebase
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
</script>

    <script>
        function salvarTutoria() {
            const form = document.getElementById('tutoriaForm');
            const formData = new FormData(form);

            fetch('http://localhost:3000/salvarTutoria', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => alert('Tutoria salva com sucesso!'))
            .catch(error => alert('Erro ao salvar tutoria: ' + error));
        }

        function clearForm() {
            document.getElementById('tutoriaForm').reset();
        }
    </script>
    <script>
        function adicionarNumero() {
            const container = document.getElementById('telefoneContainer');
            const inputGroup = document.createElement('div');
            inputGroup.className = 'input-group mb-2';
            inputGroup.innerHTML = `
                <input type="text" class="form-control" placeholder="(XX) XXXX-XXXX / (XX) XXXXX-XXXX">
                <div class="input-group-append">
                    <button class="btn btn-danger" type="button" onclick="removerNumero(this)">Remover</button>
                </div>
            `;
            container.appendChild(inputGroup);
        }

        function removerNumero(button) {
            button.closest('.input-group').remove();
        }

        // Exibir data e hora atual
        function updateDataHora() {
            const now = new Date();
            const dataHora = now.toLocaleDateString('pt-BR') + ' ' + now.toLocaleTimeString('pt-BR');
            document.getElementById('dataHora').innerText = dataHora;
        }

        setInterval(updateDataHora, 1000);

        // Fun√ß√µes para a assinatura digital
        const canvasAluno = document.getElementById('signaturePadAluno');
        const ctxAluno = canvasAluno.getContext('2d');
        let drawingAluno = false;

        function getMousePos(event, canvas) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: event.clientX - rect.left,
                y: event.clientY - rect.top
            };
        }

        function getTouchPos(event, canvas) {
            const rect = canvas.getBoundingClientRect();
            return {
                x: event.touches[0].clientX - rect.left,
                y: event.touches[0].clientY - rect.top
            };
        }

        function startPosition(event, ctx, canvas, drawing) {
            drawing = true;
            draw(event, ctx, canvas, drawing);
        }

        function endPosition(ctx) {
            drawingAluno = false;
            ctx.beginPath();
        }

        function draw(event, ctx, canvas, drawing) {
            if (!drawing) return;

            event.preventDefault(); // Evitar comportamentos padr√£o, como rolagem na touch screen
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.strokeStyle = 'black';

            let pos;

            if (event.type.includes('mouse')) {
                pos = getMousePos(event, canvas);
            } else if (event.type.includes('touch')) {
                pos = getTouchPos(event, canvas);
            }

            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        // Eventos para mouse e touch - Aluno
        canvasAluno.addEventListener('mousedown', (e) => startPosition(e, ctxAluno, canvasAluno, drawingAluno = true));
        canvasAluno.addEventListener('mouseup', () => endPosition(ctxAluno));
        canvasAluno.addEventListener('mousemove', (e) => draw(e, ctxAluno, canvasAluno, drawingAluno));

        canvasAluno.addEventListener('touchstart', (e) => startPosition(e, ctxAluno, canvasAluno, drawingAluno = true));
        canvasAluno.addEventListener('touchend', () => endPosition(ctxAluno));
        canvasAluno.addEventListener('touchmove', (e) => draw(e, ctxAluno, canvasAluno, drawingAluno));

        document.getElementById('clearSignatureAluno').addEventListener('click', () => {
            ctxAluno.clearRect(0, 0, canvasAluno.width, canvasAluno.height);
        });

        // Verificar se a senha do gestor est√° correta para desbloquear o campo de carimbo e assinatura
        document.getElementById('senhaGestor').addEventListener('input', function() {
            const senha = this.value;
            if (senha === "1234") {
                document.getElementById('carimboGestor').disabled = false;
            } else {
                document.getElementById('carimboGestor').disabled = true;
            }
        });

        // Fun√ß√£o para salvar uma tutoria
        function saveTutoria() {
             
            const nomeAluno = document.getElementById('nomeAluno').value;
            const serie = document.getElementById('serie').value;
            const nomeCompleto = `${nomeAluno} (${serie})`;

            const tutoriaData = {
                nomeTutor: document.getElementById('nomeTutor').value, // ADICIONADO
                nomeAluno: nomeCompleto,
                telefoneCelular: document.getElementById('telefoneCelular').value,
                serie: serie,
                projetoVida: document.getElementById('projetoVida').value,
                assuntoPessoal: document.getElementById('assuntoPessoal').value,
                checkPessoal: document.getElementById('checkPessoal').checked,
                checkPedagogico: document.getElementById('checkPedagogico').checked,
                checkFamilia: document.getElementById('checkFamilia').checked,
                checkEmergencia: document.getElementById('checkEmergencia').checked,
                checkProvaPaulista: document.getElementById('checkProvaPaulista').checked,
                checkNotasBimestrais: document.getElementById('checkNotasBimestrais').checked,
                checkComportamento: document.getElementById('checkComportamento').checked,
                carimboGestor: document.getElementById('carimboGestor').value,
                dataHora: document.getElementById('dataHora').innerText,
                assinaturaAluno: canvasAluno.toDataURL()
            };

            let tutorias = JSON.parse(localStorage.getItem('tutorias')) || [];
            tutorias.push(tutoriaData);
            localStorage.setItem('tutorias', JSON.stringify(tutorias));

            renderTutoriaList();
            clearForm();

            // üîê Envia para Firebase se a senha estiver correta
    const senha = document.getElementById('senhaGestor').value;
    if (senha === "1234") {
    const tutor = document.getElementById('nomeTutor').value;
    const ref = database.ref('tutorias/' + tutor).push();
    ref.set(tutoriaData)
        .then(() => console.log("Tutoria salva no Firebase por tutor"))
        .catch(error => console.error("Erro ao salvar no Firebase", error));
}
    }
          
// buscar a tutoria
function buscarTutoriasPorNome(nomeBuscado) {
    const tutor = document.getElementById('nomeTutor').value;
    const serieFiltro = document.getElementById('filtroSerie').value.toLowerCase();
    const dataFiltro = document.getElementById('filtroData').value; // formato yyyy-mm-dd

    database.ref('tutorias/' + tutor).once('value')
        .then(snapshot => {
            const todas = snapshot.val();
            const resultado = [];

            for (let id in todas) {
                const tutoria = todas[id];
                const nomeAluno = tutoria.nomeAluno.toLowerCase();
                const serie = tutoria.serie.toLowerCase();
                const dataHora = tutoria.dataHora.split(" ")[0]; // pega apenas a data
                const dataFormatada = formatarDataInput(dataHora); // converte para yyyy-mm-dd

                if (
                    nomeAluno.includes(nomeBuscado.toLowerCase()) &&
                    (serieFiltro === "" || serie.includes(serieFiltro)) &&
                    (dataFiltro === "" || dataFiltro === dataFormatada)
                ) {
                    resultado.push(tutoria);
                }
            }

            const tutoriaList = document.getElementById('tutoriaList');
            tutoriaList.innerHTML = '';

            resultado.forEach((tutoria, index) => {
                const tutoriaItem = document.createElement('div');
                tutoriaItem.className = 'tutoria-item';

                const tutoriaInfo = document.createElement('div');
                tutoriaInfo.innerHTML = `<strong>${tutoria.nomeAluno}</strong> - ${tutoria.dataHora} <span style="color: green; font-weight: bold;">üî• Firebase</span>`;

                const btnGroup = document.createElement('div');
                btnGroup.className = 'btn-group';

                const btnSavePDF = document.createElement('button');
                btnSavePDF.className = 'btn btn-sm btn-success';
                btnSavePDF.innerText = 'Salvar em PDF';
                btnSavePDF.onclick = () => {
                    const pdf = new jspdf.jsPDF();
                    pdf.text(`Tutoria de ${tutoria.nomeAluno}`, 10, 10);
                    const columns = ["Campo", "Informa√ß√£o"];
                    const rows = [
                        ["Tutor", tutoria.nomeTutor],
                        ["Telefone/Celular", tutoria.telefoneCelular],
                        ["S√©rie", tutoria.serie],
                        ["Projeto de Vida", tutoria.projetoVida],
                        ["Assunto Pessoal", tutoria.assuntoPessoal],
                        ["Check Pessoal", tutoria.checkPessoal ? 'Sim' : 'N√£o'],
                        ["Check Pedag√≥gico", tutoria.checkPedagogico ? 'Sim' : 'N√£o'],
                        ["Check Fam√≠lia", tutoria.checkFamilia ? 'Sim' : 'N√£o'],
                        ["Check Emerg√™ncia", tutoria.checkEmergencia ? 'Sim' : 'N√£o'],
                        ["Check Prova Paulista", tutoria.checkProvaPaulista ? 'Sim' : 'N√£o'],
                        ["Check Notas Bimestrais", tutoria.checkNotasBimestrais ? 'Sim' : 'N√£o'],
                        ["Check Comportamento", tutoria.checkComportamento ? 'Sim' : 'N√£o'],
                        ["Carimbo do Gestor", tutoria.carimboGestor],
                        ["Data e Hora", tutoria.dataHora]
                    ];
                    pdf.autoTable(columns, rows, { startY: 20 });

                    const imgAluno = new Image();
                    imgAluno.src = tutoria.assinaturaAluno;
                    imgAluno.onload = function () {
                        pdf.addImage(imgAluno, 'PNG', 10, pdf.autoTable.previous.finalY + 10, 180, 40);
                        pdf.save(`Tutoria_${tutoria.nomeAluno}.pdf`);
                    };
                };

                btnGroup.appendChild(btnSavePDF);
                tutoriaItem.appendChild(tutoriaInfo);
                tutoriaItem.appendChild(btnGroup);
                tutoriaList.appendChild(tutoriaItem);
            });
        })
        .catch(error => {
            console.error("Erro na busca:", error);
        });
}

// Converte de dd/mm/aaaa para yyyy-mm-dd
function formatarDataInput(dataBr) {
    const partes = dataBr.split('/');
    if (partes.length === 3) {
        return `${partes[2]}-${partes[1].padStart(2, '0')}-${partes[0].padStart(2, '0')}`;
    }
    return "";
}



        // Fun√ß√£o para limpar o formul√°rio
        function clearForm() {
            document.getElementById('tutoriaForm').reset();
            ctxAluno.clearRect(0, 0, canvasAluno.width, canvasAluno.height);
        }

        // Fun√ß√£o para renderizar a lista de tutorias
        function renderTutoriaList() {
            const tutoriaList = document.getElementById('tutoriaList');
            tutoriaList.innerHTML = '';

            let tutorias = JSON.parse(localStorage.getItem('tutorias')) || [];

            tutorias.forEach((tutoria, index) => {
                const tutoriaItem = document.createElement('div');
                tutoriaItem.className = 'tutoria-item';

                const tutoriaInfo = document.createElement('div');
                tutoriaInfo.innerHTML = `<input type="checkbox" data-index="${index}"> <strong>${tutoria.nomeAluno}</strong> - ${tutoria.dataHora}`;

                const btnGroup = document.createElement('div');
                btnGroup.className = 'btn-group';

                const btnSavePDF = document.createElement('button');
                btnSavePDF.className = 'btn btn-sm btn-success';
                btnSavePDF.innerText = 'Salvar em PDF';
                btnSavePDF.onclick = () => saveAsPDF(index);

                const btnLoad = document.createElement('button');
                btnLoad.className = 'btn btn-sm btn-primary';
                btnLoad.innerText = 'Carregar';
                btnLoad.onclick = () => loadTutoria(index);

                btnGroup.appendChild(btnSavePDF);
                btnGroup.appendChild(btnLoad);

                tutoriaItem.appendChild(tutoriaInfo);
                tutoriaItem.appendChild(btnGroup);

                tutoriaList.appendChild(tutoriaItem);
            });
        }

        // Fun√ß√£o para deletar as tutorias selecionadas
        function deleteSelected() {
            let tutorias = JSON.parse(localStorage.getItem('tutorias')) || [];
            const checkboxes = document.querySelectorAll('.tutoria-item input[type="checkbox"]:checked');

            checkboxes.forEach(checkbox => {
                const index = checkbox.getAttribute('data-index');
                tutorias.splice(index, 1);
            });

            localStorage.setItem('tutorias', JSON.stringify(tutorias));
            renderTutoriaList();
        }

        // Fun√ß√£o para carregar uma tutoria para edi√ß√£o
        function loadTutoria(index) {
            let tutorias = JSON.parse(localStorage.getItem('tutorias')) || [];
            const tutoria = tutorias[index];
            document.getElementById('nomeTutor').value = tutoria.nomeTutor || ''; 
            document.getElementById('nomeAluno').value = tutoria.nomeAluno;
            document.getElementById('telefoneCelular').value = tutoria.telefoneCelular;
            document.getElementById('serie').value = tutoria.serie;
            document.getElementById('projetoVida').value = tutoria.projetoVida;
            document.getElementById('assuntoPessoal').value = tutoria.assuntoPessoal;
            document.getElementById('checkPessoal').checked = tutoria.checkPessoal;
            document.getElementById('checkPedagogico').checked = tutoria.checkPedagogico;
            document.getElementById('checkFamilia').checked = tutoria.checkFamilia;
            document.getElementById('checkEmergencia').checked = tutoria.checkEmergencia;
            document.getElementById('checkProvaPaulista').checked = tutoria.checkProvaPaulista;
            document.getElementById('checkNotasBimestrais').checked = tutoria.checkNotasBimestrais;
            document.getElementById('checkComportamento').checked = tutoria.checkComportamento;
            document.getElementById('carimboGestor').value = tutoria.carimboGestor;
            document.getElementById('dataHora').innerText = tutoria.dataHora;

            const imgAluno = new Image();
            imgAluno.src = tutoria.assinaturaAluno;
            imgAluno.onload = function () {
                ctxAluno.clearRect(0, 0, canvasAluno.width, canvasAluno.height);
                ctxAluno.drawImage(imgAluno, 0, 0);
            };
        }

        // Fun√ß√£o para salvar uma tutoria como PDF
        function saveAsPDF(index) {
            let tutorias = JSON.parse(localStorage.getItem('tutorias')) || [];
            const tutoria = tutorias[index];

            const pdf = new jspdf.jsPDF();
            pdf.text(`Tutoria de ${tutoria.nomeAluno}`, 10, 10);

            // Cria a estrutura da "planilha"
            const columns = ["Campo", "Informa√ß√£o"];
            const rows = [
                ["Tutor", tutoria.nomeTutor], // ADICIONADO
                ["Telefone/Celular", tutoria.telefoneCelular],
                ["S√©rie", tutoria.serie],
                ["Projeto de Vida", tutoria.projetoVida],
                ["Assunto Pessoal", tutoria.assuntoPessoal],
                ["Check Pessoal", tutoria.checkPessoal ? 'Sim' : 'N√£o'],
                ["Check Pedag√≥gico", tutoria.checkPedagogico ? 'Sim' : 'N√£o'],
                ["Check Fam√≠lia", tutoria.checkFamilia ? 'Sim' : 'N√£o'],
                ["Check Emerg√™ncia", tutoria.checkEmergencia ? 'Sim' : 'N√£o'],
                ["Check Prova Paulista", tutoria.checkProvaPaulista ? 'Sim' : 'N√£o'],
                ["Check Notas Bimestrais", tutoria.checkNotasBimestrais ? 'Sim' : 'N√£o'],
                ["Check Comportamento", tutoria.checkComportamento ? 'Sim' : 'N√£o'],
                ["Carimbo do Gestor", tutoria.carimboGestor],
                ["Data e Hora", tutoria.dataHora]
            ];

            pdf.autoTable(columns, rows, { startY: 20 });

            // Ajusta a posi√ß√£o da assinatura do aluno
            const imgAluno = new Image();
            imgAluno.src = tutoria.assinaturaAluno;
            imgAluno.onload = function () {
                pdf.addImage(imgAluno, 'PNG', 10, pdf.autoTable.previous.finalY + 10, 180, 40);
                pdf.save(`Tutoria_${tutoria.nomeAluno}.pdf`);
            };
        }

        // Fun√ß√£o para enviar o link para o WhatsApp
        function sendWhatsApp() {
            const numero = '14996002310'; // Insira o n√∫mero do destinat√°rio aqui
            const mensagem = 'Aqui est√° o relat√≥rio de tutoria. Por favor, anexe o arquivo PDF manualmente.';
            const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
            window.open(url, '_blank');
        }
       

        // Inicializar a lista de tutorias
        renderTutoriaList();

        // validar tutoria

        function validarSenhaModal() {
    const senha = document.getElementById('senhaModal').value;
    const nome = document.getElementById('filtroNome').value;

    if (senha === "1234") {
        $('#modalSenha').modal('hide'); // Fecha o modal
        buscarTutoriasPorNome(nome);   // Executa a busca
    } else {
        alert("Senha incorreta! Acesso negado √† busca.");
    }

    
}




    </script>
</body>
</html>
